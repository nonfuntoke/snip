<style>
:root {
  --primary: #2563eb;
  --primary-dark: #1d4ed8;
  --secondary: #64748b;
  --success: #22c55e;
  --background: #fff3f;
  --white: #ffffff;
  --text-primary: #1e293b;
  --text-secondary: #475569;
  --border: #e2e8f0;
}

body {
  font-family: 'Inter', sans-serif;
  background-color: var(--background);
  margin: 0;
  padding: 0;
  color: var(--text-primary);
  line-height: 1.5;
}

.container {
  max-width: 800px;
  margin: 0 auto;
  padding: 1.5rem;
}

.intro-section {
  text-align: center;
  margin: 2rem 0;
  opacity: 1;
  transition: opacity 0.3s ease;
}

.intro-section h1 {
  font-size: 2rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 1rem;
}

.intro-section p {
  font-size: 1rem;
  color: var(--text-secondary);
  max-width: 500px;
  margin: 0 auto 1.5rem;
  line-height: 1.5;
}

.btn {
  padding: 0.625rem 1.5rem;
  border-radius: 0.5rem;
  font-weight: 500;
  font-size: 0.875rem;
  transition: all 0.2s ease;
  cursor: pointer;
}

.btn-primary {
  background-color: var(--primary);
  color: var(--white);
  border: none;
}

.btn-primary:hover {
  background-color: var(--primary-dark);
  transform: translateY(-1px);
}

.multi-step-form {
  background-color: var(--white);
  border-radius: 0.75rem;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  padding: 1.5rem;
  display: none;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.multi-step-form.visible {
  display: block;
  opacity: 1;
}

.step-indicator {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 300px;
  margin: 0 auto 2rem;
  position: relative;
}

.step-indicator::before {
  content: '';
  position: absolute;
  height: 3px;
  background-color: var(--border);
  width: 100%;
  top: 50%;
  transform: translateY(-50%);
  z-index: 0;
}

.step-progress {
  position: absolute;
  height: 3px;
  background-color: var(--primary);
  width: 0%;
  top: 50%;
  transform: translateY(-50%);
  z-index: 1;
  transition: width 0.3s ease;
}

.step {
  width: 2rem;
  height: 2rem;
  border-radius: 50%;
  background-color: var(--white);
  border: 2px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 500;
  font-size: 0.875rem;
  position: relative;
  z-index: 2;
  transition: all 0.3s ease;
}

.step.active {
  border-color: var(--primary);
  background-color: var(--primary);
  color: var(--white);
}

.step.completed {
  border-color: var(--success);
  background-color: var(--success);
  color: var(--white);
}

.form-step {
  display: none;
}

.form-step.active {
  display: block;
  animation: slideIn 0.3s ease-out forwards;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.form-group {
  margin-bottom: 1.5rem;
}

.form-label {
  display: block;
  font-weight: 500;
  margin-bottom: 0.5rem;
  color: var(--text-primary);
  font-size: 0.875rem;
}

.form-input,
.form-select,
textarea.form-input {
  width: 100%;
  padding: 0.625rem;
  border: 1px solid var(--border);
  border-radius: 0.5rem;
  font-size: 0.875rem;
  transition: all 0.2s ease;
  background-color: var(--white);
}

.form-input:focus,
.form-select:focus,
textarea.form-input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
}

.form-input.error,
.form-select.error {
  border-color: #ef4444;
}

.error-message {
  color: #ef4444;
  font-size: 0.75rem;
  margin-top: 0.25rem;
}

.radio-group {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 0.75rem;
}

.radio-option {
  background-color: var(--white);
  border: 1px solid var(--border);
  border-radius: 0.5rem;
  padding: 1rem;
  cursor: pointer;
  transition: all 0.2s ease;
}

.radio-option:hover {
  border-color: var(--primary);
  transform: translateY(-1px);
}

.radio-option.selected {
  border-color: var(--primary);
  background-color: rgba(37, 99, 235, 0.05);
}

.radio-option h3 {
  margin: 0 0 0.25rem;
  color: var(--text-primary);
  font-size: 0.875rem;
  font-weight: 600;
}

.radio-option p {
  margin: 0;
  color: var(--text-secondary);
  font-size: 0.75rem;
}

.navigation-buttons {
  display: flex;
  justify-content: space-between;
  margin-top: 2rem;
}

.btn-secondary {
  background-color: var(--white);
  border: 1px solid var(--primary);
  color: var(--primary);
}

.btn-secondary:hover {
  background-color: rgba(37, 99, 235, 0.05);
}

.loading {
  display: none;
  flex-direction: column;
  align-items: center;
  margin: 2rem 0;
}

.loading-spinner {
  width: 2.5rem;
  height: 2.5rem;
  border: 2px solid var(--border);
  border-top-color: var(--primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
/* Add styles for suggestions */
.suggestions-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.suggestion-chip {
    background-color: var(--background);
    border: 1px solid var(--border);
    border-radius: 1rem;
    padding: 0.25rem 0.75rem;
    font-size: 0.75rem;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
}

.suggestion-chip:hover {
    background-color: var(--primary);
    color: var(--white);
    border-color: var(--primary);
}

.loading p {
  margin-top: 1rem;
  color: var(--text-secondary);
  font-size: 0.875rem;
}

.results-section {
  display: none;
  margin-top: 2rem;
}

.results-section h2 {
  text-align: center;
  margin-bottom: 2rem;
  color: var(--text-primary);
  font-size: 1.5rem;
}

.results-container {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

.niche-card {
  background-color: var(--white);
  border-radius: 0.75rem;
  padding: 1.5rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  transition: transform 0.2s ease;
}

.niche-card:hover {
  transform: translateY(-2px);
}

.niche-header {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin-bottom: 1rem;
  padding-bottom: 0.75rem;
  border-bottom: 1px solid var(--border);
}

.niche-icon {
  font-size: 1.5rem;
}

.niche-title {
  font-size: 1.125rem;
  font-weight: 600;
  color: var(--text-primary);
  margin: 0;
}

.niche-description {
  color: var(--text-secondary);
  font-size: 0.875rem;
  line-height: 1.5;
  margin-bottom: 1.25rem;
}

.niche-metrics {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 1rem;
  background-color: var(--background);
  padding: 1rem;
  border-radius: 0.5rem;
  margin-bottom: 1.25rem;
}

.metric {
  text-align: center;
}

.metric-icon {
  font-size: 1rem;
  margin-bottom: 0.25rem;
}

.metric span {
  display: block;
  font-size: 0.75rem;
  color: var(--text-secondary);
}

.metric span:nth-child(2) {
  font-weight: 500;
  color: var(--text-primary);
  margin: 0.25rem 0;
}

.key-topics {
  background-color: var(--background);
  padding: 1rem;
  border-radius: 0.5rem;
}

.key-topics h4 {
  font-size: 0.875rem;
  color: var(--text-primary);
  margin: 0 0 0.75rem 0;
}

.key-topics ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.key-topics li {
  font-size: 0.75rem;
  color: var(--text-secondary);
  padding: 0.375rem 0;
  border-bottom: 1px solid var(--border);
}

.key-topics li:last-child {
  border-bottom: none;
}

.reset-button {
  display: block;
  margin: 2rem auto 0;
}

.toast {
  position: fixed;
  bottom: 1.5rem;
  left: 50%;
  transform: translateX(-50%) translateY(100%);
  background-color: var(--text-primary);
  color: var(--white);
  padding: 0.75rem 1.5rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  opacity: 0;
  transition: all 0.3s ease;
  z-index: 50;
}

.toast.show {
  transform: translateX(-50%) translateY(0);
  opacity: 1;
}
/* Add styles for suggestions */
.suggestions-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.suggestion-chip {
    background-color: var(--background);
    border: 1px solid var(--border);
    border-radius: 1rem;
    padding: 0.25rem 0.75rem;
    font-size: 0.75rem;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.2s ease;
}

.suggestion-chip:hover {
    background-color: var(--primary);
    color: var(--white);
    border-color: var(--primary);
}


</style>

<div class="container">
        <div class="intro-section">
            <h1>Discover Profitable Email Marketing Niches</h1>
            <p>Answer a few questions, get AI-driven niche insights, and start creating targeted campaigns for your audience.</p>
            <button id="startDiscovery" class="btn btn-primary">Start Your Niche Discovery</button>
        </div>

        <form id="nicheAnalysisForm" class="multi-step-form">
            <div class="step-indicator">
                <div class="step-progress"></div>
                <div class="step active" data-step="1">1</div>
                <div class="step" data-step="2">2</div>
                <div class="step" data-step="3">3</div>
                <div class="step" data-step="4">4</div>
            </div>

            <div class="form-step active" data-step="1">
                <div class="form-group">
                    <label class="form-label">Select Your Industry</label>
                    <select id="industry" class="form-select" required>
                        <option value="">Choose an industry...</option>
                        <option value="technology">Technology</option>
                        <option value="finance">Finance</option>
                        <option value="healthcare">Healthcare</option>
                        <option value="education">Education</option>
                        <option value="ecommerce">E-commerce</option>
                        <option value="lifestyle">Lifestyle</option>
                        <option value="travel">Travel</option>
                        <option value="food">Food & Beverage</option>
                        <option value="fitness">Fitness & Wellness</option>
                        <option value="other">Other</option>
                    </select>
                </div>
            </div>

            <div class="form-step" data-step="2">
                <div class="form-group">
                    <label class="form-label">Target Audience Demographics</label>
                    <textarea id="demographics" class="form-input" rows="4" 
                        placeholder="Describe your target audience (age range, location, interests, etc.)" 
                        required></textarea>
                </div>
            </div>

            <div class="form-step" data-step="3">
                <div class="form-group">
                    <label class="form-label">Content Focus</label>
                    <div class="radio-group" id="contentFocus">
                        <div class="radio-option" data-value="informational">
                            <h3>Informational</h3>
                            <p>Educational content and industry insights</p>
                        </div>
                        <div class="radio-option" data-value="promotional">
                            <h3>Promotional</h3>
                            <p>Product launches and special offers</p>
                        </div>
                        <div class="radio-option" data-value="educational">
                            <h3>Educational</h3>
                            <p>Tutorials and how-to guides</p>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Campaign Goals</label>
                    <select id="campaignGoals" class="form-select" required>
                        <option value="">Select your primary goal...</option>
                        <option value="engagement">Increase Engagement</option>
                        <option value="leads">Generate Leads</option>
                        <option value="sales">Drive Sales</option>
                        <option value="awareness">Build Brand Awareness</option>
                        <option value="retention">Customer Retention</option>
                    </select>
                </div>
            </div>

            <div class="form-step" data-step="4">
                <div class="form-group">
                    <label class="form-label">Current Trends & Topics of Interest</label>
                    <textarea id="trends" class="form-input" rows="4" 
                        placeholder="List current trends or topics relevant to your industry" 
                        required></textarea>
                </div>
            </div>

            <div class="navigation-buttons">
                <button type="button" class="btn btn-secondary prev-button" style="display: none;">Previous</button>
                <button type="button" class="btn btn-primary next-button">Next</button>
            </div>
        </form>

        <div class="loading">
            <div class="loading-spinner"></div>
            <p>Analyzing your inputs for niche recommendations...</p>
        </div>

        <div class="results-section">
            <h2>Your Niche Analysis Results</h2>
            <div class="results-container" id="nicheResults"></div>
        </div>
    </div>

<script>
class NicheAnalyzer {
    constructor() {
        this.currentStep = 1;
        this.totalSteps = 4;
        this.selectedContentFocus = '';
        this.retryAttempts = 3;
        this.retryDelay = 1000;
        this.rateLimitDelay = 100;
        this.lastRequestTime = 0;
        this.conversationHistory = [];
        this.suggestions = {
            demographics: [
                "25-34 urban professionals",
                "Small business owners",
                "Remote workers",
                "Digital entrepreneurs",
                "Tech-savvy millennials",
                "Creative freelancers"
            ],
            trends: [
                "AI and automation",
                "Sustainable practices",
                "Remote work solutions",
                "Digital transformation",
                "Personal branding",
                "Social commerce"
            ]
        };
        this.initializeEventListeners();
        this.updateStepProgress();
        this.initializeSuggestions();
    }

    initializeEventListeners() {
        document.getElementById('startDiscovery').addEventListener('click', () => this.startDiscovery());
        document.querySelectorAll('.radio-option').forEach(option => {
            option.addEventListener('click', (e) => this.handleContentFocusSelection(e));
        });
        document.querySelector('.next-button').addEventListener('click', () => this.handleNavigation('next'));
        document.querySelector('.prev-button').addEventListener('click', () => this.handleNavigation('prev'));
    }

    initializeSuggestions() {
        this.addSuggestionsToField('demographics');
        this.addSuggestionsToField('trends');
    }

    addSuggestionsToField(fieldId) {
        const field = document.getElementById(fieldId);
        const container = document.createElement('div');
        container.className = 'suggestions-container';

        this.suggestions[fieldId].forEach(suggestion => {
            const chip = document.createElement('span');
            chip.className = 'suggestion-chip';
            chip.textContent = suggestion;
            chip.addEventListener('click', () => {
                const currentValue = field.value.trim();
                field.value = currentValue ? `${currentValue}, ${suggestion}` : suggestion;
            });
            container.appendChild(chip);
        });

        field.parentNode.insertBefore(container, field.nextSibling);
    }

    updateStepProgress() {
        const progress = document.querySelector('.step-progress');
        const percentage = ((this.currentStep - 1) / (this.totalSteps - 1)) * 100;
        progress.style.width = `${percentage}%`;

        document.querySelectorAll('.step').forEach((step, index) => {
            step.classList.remove('active', 'completed');
            if (index + 1 < this.currentStep) {
                step.classList.add('completed');
            } else if (index + 1 === this.currentStep) {
                step.classList.add('active');
            }
        });
    }

    startDiscovery() {
        const intro = document.querySelector('.intro-section');
        const form = document.querySelector('.multi-step-form');
        
        intro.style.opacity = '0';
        setTimeout(() => {
            intro.style.display = 'none';
            form.style.display = 'block';
            setTimeout(() => {
                form.style.opacity = '1';
                this.updateStepProgress();
            }, 50);
        }, 300);
    }

    handleContentFocusSelection(event) {
        const option = event.currentTarget;
        document.querySelectorAll('.radio-option').forEach(opt => opt.classList.remove('selected'));
        option.classList.add('selected');
        this.selectedContentFocus = option.dataset.value;
    }

    handleNavigation(direction) {
        if (direction === 'next') {
            if (this.validateStep(this.currentStep)) {
                if (this.currentStep < this.totalSteps) {
                    this.showStep(this.currentStep + 1);
                } else {
                    this.submitForm();
                }
            }
        } else {
            if (this.currentStep > 1) {
                this.showStep(this.currentStep - 1);
            }
        }
    }

    showStep(step) {
        document.querySelectorAll('.form-step').forEach(s => s.classList.remove('active'));
        document.querySelector(`.form-step[data-step="${step}"]`).classList.add('active');
        this.currentStep = step;
        this.updateStepProgress();
        this.updateNavigationButtons();
    }

    updateNavigationButtons() {
        const prevButton = document.querySelector('.prev-button');
        const nextButton = document.querySelector('.next-button');
        
        prevButton.style.display = this.currentStep > 1 ? 'block' : 'none';
        nextButton.textContent = this.currentStep === this.totalSteps ? 'Analyze' : 'Next';
    }

    validateStep(step) {
        const currentStep = document.querySelector(`.form-step[data-step="${step}"]`);
        let isValid = true;

        currentStep.querySelectorAll('[required]').forEach(field => {
            if (!field.value) {
                isValid = false;
                field.classList.add('error');
                this.showError(field, 'This field is required');
            } else {
                field.classList.remove('error');
                this.clearError(field);
            }
        });

        if (step === 3 && !this.selectedContentFocus) {
            isValid = false;
            this.showToast('Please select a content focus');
        }

        return isValid;
    }

    showError(field, message) {
        let errorDiv = field.nextElementSibling;
        if (!errorDiv || !errorDiv.classList.contains('error-message')) {
            errorDiv = document.createElement('div');
            errorDiv.classList.add('error-message');
            field.parentNode.insertBefore(errorDiv, field.nextSibling);
        }
        errorDiv.textContent = message;
    }

    clearError(field) {
        const errorDiv = field.nextElementSibling;
        if (errorDiv && errorDiv.classList.contains('error-message')) {
            errorDiv.remove();
        }
    }

    showToast(message) {
        const toast = document.createElement('div');
        toast.classList.add('toast');
        toast.textContent = message;
        document.body.appendChild(toast);
        
        setTimeout(() => {
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }, 100);
    }

    async submitForm() {
        const form = document.querySelector('.multi-step-form');
        const loading = document.querySelector('.loading');
        
        form.style.display = 'none';
        loading.style.display = 'flex';

        try {
            const formData = {
                industry: document.getElementById('industry').value,
                demographics: document.getElementById('demographics').value,
                contentFocus: this.selectedContentFocus,
                campaignGoals: document.getElementById('campaignGoals').value,
                trends: document.getElementById('trends').value
            };

            const response = await this.analyzeNiche(formData);
            this.displayResults(response.analysis);
        } catch (error) {
            this.showToast(error.message || 'An error occurred while analyzing the niche.');
            form.style.display = 'block';
        } finally {
            loading.style.display = 'none';
        }
    }

    async analyzeNiche(formData) {
        try {
            const response = await this.callGeminiAPI(formData);
            return response;
        } catch (error) {
            console.error('API Error:', error);
            return this.getFallbackResponse(formData);
        }
    }

    async callGeminiAPI(formData) {
        // Simulated API call for demonstration
        return new Promise((resolve) => {
            setTimeout(() => {
                resolve({
                    success: true,
                    analysis: [
                        {
                            title: `${formData.industry} Innovation Hub`,
                            description: `Specialized solutions for ${formData.demographics} focusing on ${formData.contentFocus} content.`,
                            icon: "ðŸš€",
                            metrics: {
                                marketSize: "Expanding",
                                competition: "Moderate",
                                profitPotential: "High"
                            },
                            keyTopics: [
                                `${formData.industry} trends and insights`,
                                "Innovation strategies",
                                "Market opportunities"
                            ]
                        },
                        {
                            title: `Digital ${formData.industry} Solutions`,
                            description: "Modern solutions leveraging technology and digital transformation.",
                            icon: "ðŸ’¡",
                            metrics: {
                                marketSize: "Large",
                                competition: "Medium",
                                profitPotential: "Very High"
                            },
                            keyTopics: [
                                "Digital transformation",
                                "Technology integration",
                                "Process optimization"
                            ]
                        },
                        {
                            title: `${formData.industry} Education Platform`,
                            description: "Professional development and learning resources.",
                            icon: "ðŸ“š",
                            metrics: {
                                marketSize: "Growing",
                                competition: "Low",
                                profitPotential: "High"
                            },
                            keyTopics: [
                                "Professional training",
                                "Skill development",
                                "Industry certifications"
                            ]
                        }
                    ]
                });
            }, 2000);
        });
    }

    displayResults(analysis) {
        const resultsSection = document.querySelector('.results-section');
        const resultsContainer = document.getElementById('nicheResults');
        resultsContainer.innerHTML = '';

        const displayedResults = analysis.slice(0, 3);

        displayedResults.forEach((niche, index) => {
            const card = this.createNicheCard(niche, index);
            resultsContainer.appendChild(card);
        });

        const restartButton = document.createElement('button');
        restartButton.className = 'restart-button';
        restartButton.textContent = 'Start New Analysis';
        restartButton.addEventListener('click', () => this.restartAnalysis());
        resultsContainer.appendChild(restartButton);

        resultsSection.style.display = 'block';
    }

    createNicheCard(niche, index) {
        const card = document.createElement('div');
        card.className = 'niche-card';

        const header = document.createElement('div');
        header.className = 'niche-header';
        header.innerHTML = `
            <span class="niche-icon">${niche.icon}</span>
            <h3 class="niche-title">${niche.title}</h3>
        `;

        const content = document.createElement('div');
        content.className = 'niche-content';
        content.innerHTML = `
            <p class="niche-description">${niche.description}</p>
            <div class="niche-metrics">
                <div class="metric">
                    <span class="metric-icon">ðŸ“Š</span>
                    <span>Market: ${niche.metrics.marketSize}</span>
                </div>
                <div class="metric">
                    <span class="metric-icon">ðŸŽ¯</span>
                    <span>Competition: ${niche.metrics.competition}</span>
                </div>
                <div class="metric">
                    <span class="metric-icon">ðŸ’°</span>
                    <span>Potential: ${niche.metrics.profitPotential}</span>
                </div>
            </div>
            <div class="key-topics">
                <h4>Key Topics</h4>
                <ul>
                    ${niche.keyTopics.map(topic => `<li>${topic}</li>`).join('')}
                </ul>
            </div>
        `;

        card.appendChild(header);
        card.appendChild(content);
        return card;
    }

    restartAnalysis() {
        document.getElementById('nicheAnalysisForm').reset();
        this.selectedContentFocus = '';
        document.querySelectorAll('.radio-option').forEach(opt => opt.classList.remove('selected'));
        
        document.querySelector('.results-section').style.display = 'none';
        document.querySelector('.multi-step-form').style.display = 'none';
        
        const intro = document.querySelector('.intro-section');
        intro.style.display = 'block';
        setTimeout(() => {
            intro.style.opacity = '1';
        }, 50);

        this.currentStep = 1;
        this.updateStepProgress();
    }
}

document.addEventListener('DOMContentLoaded', () => {
    new NicheAnalyzer();
});
</script>